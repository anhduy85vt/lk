<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản lý Nhập hàng - ANH DUY TECH</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body { background: #0f172a; color: white; font-family: 'Segoe UI', sans-serif; min-height: 100vh; }
        .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
        input, select { background: #1e293b !important; border: 1px solid rgba(255,255,255,0.1) !important; color: white !important; }
    </style>
</head>
<body class="p-6">

    <div class="max-w-7xl mx-auto">
        <div class="flex justify-between items-center mb-10">
            <div>
                <h1 class="text-3xl font-black italic text-emerald-400 uppercase tracking-tighter">ANH DUY TECH</h1>
                <p class="text-[10px] text-gray-500 font-bold uppercase tracking-[0.3em]">Inventory & Stock Management</p>
            </div>
            <div class="flex gap-3">
                <button onclick="exportToExcel()" class="bg-emerald-600 hover:bg-emerald-500 px-6 py-3 rounded-2xl font-bold flex items-center gap-2 transition-all shadow-lg shadow-emerald-500/20">
                    <i class="fas fa-file-excel"></i> XUẤT EXCEL
                </button>
                <button onclick="toggleModal()" class="bg-blue-600 hover:bg-blue-500 px-6 py-3 rounded-2xl font-bold flex items-center gap-2 transition-all shadow-lg shadow-blue-500/20">
                    <i class="fas fa-plus"></i> NHẬP HÀNG MỚI
                </button>
            </div>
        </div>

        <div class="grid grid-cols-12 gap-4 mb-6">
            <div class="col-span-8 relative">
                <i class="fas fa-search absolute left-4 top-4 text-gray-500"></i>
                <input id="search-input" oninput="renderInventory()" type="text" placeholder="Tìm tên linh kiện, mã hàng, nhà cung cấp..." class="w-full p-3 pl-12 rounded-2xl outline-none focus:border-emerald-500">
            </div>
            <div class="col-span-4">
                <select id="filter-category" onchange="renderInventory()" class="w-full p-3 rounded-2xl outline-none focus:border-emerald-500">
                    <option value="">Tất cả danh mục</option>
                    <option value="RAM">RAM</option>
                    <option value="SSD">Ổ cứng SSD/HDD</option>
                    <option value="Mainboard">Mainboard</option>
                    <option value="VGA">Card đồ họa (VGA)</option>
                    <option value="Screen">Màn hình</option>
                    <option value="Khác">Linh kiện khác</option>
                </select>
            </div>
        </div>

        <div class="glass rounded-[30px] overflow-hidden shadow-2xl">
            <table class="w-full text-left">
                <thead class="bg-white/5 text-gray-400 text-[10px] uppercase font-black tracking-widest">
                    <tr>
                        <th class="p-5">Ngày Nhập</th>
                        <th class="p-5">Linh Kiện</th>
                        <th class="p-5">Danh Mục</th>
                        <th class="p-5">Số Lượng</th>
                        <th class="p-5">Giá Nhập</th>
                        <th class="p-5">Nhà Cung Cấp</th>
                        <th class="p-5 text-right">Thao Tác</th>
                    </tr>
                </thead>
                <tbody id="inventory-list" class="divide-y divide-white/5">
                    </tbody>
            </table>
        </div>
    </div>

    <div id="modal" class="fixed inset-0 bg-black/90 hidden flex items-center justify-center z-50 p-4 backdrop-blur-md">
        <div class="glass w-full max-w-lg p-8 rounded-[40px] border-2 border-emerald-500/30">
            <h2 class="text-2xl font-black mb-6 uppercase text-emerald-400 italic flex items-center gap-3">
                <i class="fas fa-box-open"></i> Phiếu Nhập Kho
            </h2>
            <div class="space-y-4">
                <div class="grid grid-cols-2 gap-4">
                    <input id="in-date" type="date" class="p-4 rounded-2xl outline-none text-sm">
                    <select id="in-cate" class="p-4 rounded-2xl outline-none text-sm">
                        <option value="Khác">Chọn danh mục</option>
                        <option value="RAM">RAM</option>
                        <option value="SSD">SSD/HDD</option>
                        <option value="Mainboard">Mainboard</option>
                        <option value="VGA">VGA</option>
                        <option value="Screen">Màn hình</option>
                    </select>
                </div>
                <input id="in-name" type="text" placeholder="Tên linh kiện (VD: RAM Samsung 8GB DDR4)" class="w-full p-4 rounded-2xl outline-none text-sm">
                <div class="grid grid-cols-2 gap-4">
                    <input id="in-qty" type="number" placeholder="Số lượng" class="p-4 rounded-2xl outline-none text-sm">
                    <input id="in-price" type="number" placeholder="Giá nhập / món" class="p-4 rounded-2xl outline-none text-sm">
                </div>
                <input id="in-supplier" type="text" placeholder="Nhà cung cấp (Tên đại lý, Số điện thoại)" class="w-full p-4 rounded-2xl outline-none text-sm">
                <textarea id="in-note" placeholder="Ghi chú thêm (Số lô, tình trạng hàng...)" class="w-full p-4 rounded-2xl outline-none text-sm h-20"></textarea>
            </div>
            <div class="flex gap-4 mt-8">
                <button onclick="toggleModal()" class="flex-1 py-4 font-bold text-gray-400">HỦY</button>
                <button onclick="addInventory()" class="flex-1 bg-emerald-600 py-4 rounded-2xl font-black uppercase tracking-widest hover:bg-emerald-500 transition-all">NHẬP KHO</button>
            </div>
        </div>
    </div>

    <script>
        let inventory = JSON.parse(localStorage.getItem('adtech_inventory')) || [];

        function toggleModal() {
            document.getElementById('modal').classList.toggle('hidden');
            document.getElementById('in-date').valueAsDate = new Date();
        }

        function addInventory() {
            const item = {
                id: Date.now(),
                date: document.getElementById('in-date').value,
                name: document.getElementById('in-name').value,
                cate: document.getElementById('in-cate').value,
                qty: parseInt(document.getElementById('in-qty').value) || 0,
                price: parseInt(document.getElementById('in-price').value) || 0,
                supplier: document.getElementById('in-supplier').value,
                note: document.getElementById('in-note').value
            };

            if(!item.name || item.qty <= 0) return alert("Vui lòng nhập tên và số lượng!");

            inventory.push(item);
            saveData();
            renderInventory();
            toggleModal();
            // Reset form
            ['in-name','in-qty','in-price','in-supplier','in-note'].forEach(id => document.getElementById(id).value = '');
        }

        function deleteItem(id) {
            if(confirm("Xóa dòng nhập hàng này?")) {
                inventory = inventory.filter(x => x.id !== id);
                saveData();
                renderInventory();
            }
        }

        function saveData() {
            localStorage.setItem('adtech_inventory', JSON.stringify(inventory));
        }

        function renderInventory() {
            const list = document.getElementById('inventory-list');
            const search = document.getElementById('search-input').value.toLowerCase();
            const filterCate = document.getElementById('filter-category').value;
            
            list.innerHTML = '';

            inventory.sort((a,b) => new Date(b.date) - new Date(a.date)).forEach(item => {
                const matchSearch = item.name.toLowerCase().includes(search) || item.supplier.toLowerCase().includes(search);
                const matchCate = filterCate === "" || item.cate === filterCate;

                if(matchSearch && matchCate) {
                    list.innerHTML += `
                        <tr class="hover:bg-white/[0.02] transition-all border-b border-white/5">
                            <td class="p-5 text-gray-500 text-xs">${item.date}</td>
                            <td class="p-5 font-bold uppercase text-emerald-400">${item.name}<br><span class="text-[10px] text-gray-500 font-normal italic">${item.note}</span></td>
                            <td class="p-5"><span class="bg-white/10 px-3 py-1 rounded-full text-[10px] font-bold">${item.cate}</span></td>
                            <td class="p-5 font-black text-lg text-white">${item.qty} <span class="text-[10px] text-gray-500">Cái</span></td>
                            <td class="p-5 font-black text-white">${item.price.toLocaleString()}đ</td>
                            <td class="p-5 text-gray-400 text-xs font-bold uppercase">${item.supplier}</td>
                            <td class="p-5 text-right">
                                <button onclick="deleteItem(${item.id})" class="w-10 h-10 rounded-xl bg-red-500/10 text-red-500 hover:bg-red-500 hover:text-white transition-all">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </td>
                        </tr>
                    `;
                }
            });
        }

        function exportToExcel() {
            if(inventory.length === 0) return alert("Không có dữ liệu để xuất!");
            
            // Chuẩn bị dữ liệu để xuất
            const dataToExport = inventory.map(item => ({
                "Ngày Nhập": item.date,
                "Tên Linh Kiện": item.name,
                "Danh Mục": item.cate,
                "Số Lượng": item.qty,
                "Giá Nhập": item.price,
                "Thành Tiền": item.qty * item.price,
                "Nhà Cung Cấp": item.supplier,
                "Ghi Chú": item.note
            }));

            const worksheet = XLSX.utils.json_to_sheet(dataToExport);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, "Inventory");

            // Xuất file
            XLSX.writeFile(workbook, `NhapHang_AnhDuyTech_${new Date().toLocaleDateString()}.xlsx`);
        }

        renderInventory();
    </script>
</body>
</html>